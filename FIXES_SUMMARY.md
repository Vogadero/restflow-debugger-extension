# RestFlow 功能总结

RestFlow是一款优雅的API调试工具，专为前端开发者打造。本文档总结了所有核心功能和特性。

## 📋 核心功能

### 1. 请求捕获与管理
- ✅ **自动捕获** - 自动拦截页面中的fetch和XMLHttpRequest请求
- ✅ **智能去重** - 500ms窗口内的重复请求自动过滤
- ✅ **完整性过滤** - 只显示有响应和耗时的完整请求
- ✅ **请求列表** - 实时显示捕获的请求，支持滚动查看
- ✅ **请求计数** - 显示当前过滤后的请求数量

### 2. 请求详情展示
- ✅ **基本信息** - 名称、类型、方法、URL、远程地址、状态、时间、耗时
- ✅ **URL解码** - 自动解码中文等编码字符
- ✅ **查询参数** - GET请求参数独立展示（格式化/原始双视图）
- ✅ **请求头** - 支持格式化和原始两种展示模式
- ✅ **请求体** - JSON树形展示，支持展开/折叠
- ✅ **响应头** - 完整的响应头信息
- ✅ **响应体** - JSON树形展示，默认全部展开

### 3. 搜索与过滤
- ✅ **搜索功能** - 实时搜索URL
- ✅ **清空按钮** - 有值时自动显示清空按钮
- ✅ **方法过滤** - 🟢 GET、🟡 POST、🔵 PUT、🔴 DELETE、🟣 PATCH、⚫ HEAD、🟠 OPTIONS
- ✅ **状态过滤** - ℹ️ 1xx、✅ 2xx、↪️ 3xx、⚠️ 4xx、❌ 5xx、⏳ 待响应
- ✅ **类型过滤** - 🔍 自动捕获、🔄 重放请求、✏️ 自定义请求、📋 导入请求

### 4. 复制功能
- ✅ **基本信息复制** - 一键复制完整的基本信息
- ✅ **查询参数复制** - 复制GET请求参数
- ✅ **请求头复制** - 复制请求头JSON
- ✅ **请求体复制** - 根据视图模式智能复制（格式化/紧凑）
- ✅ **响应头复制** - 复制响应头JSON
- ✅ **响应体复制** - 根据视图模式智能复制（格式化/紧凑）
- ✅ **备用方案** - 自动降级到execCommand

### 5. 代码生成器
- ✅ **cURL (CMD)** - Windows命令行格式
- ✅ **cURL (Bash)** - Linux/Mac格式
- ✅ **PowerShell** - PowerShell脚本
- ✅ **Fetch** - 浏览器Fetch API
- ✅ **Fetch (Node.js)** - Node.js环境

### 6. 请求编辑
- ✅ **新建请求** - 创建自定义请求
- ✅ **编辑请求** - 修改现有请求
- ✅ **方法选择** - 支持所有HTTP方法（带emoji）
- ✅ **URL编辑** - 完整的URL输入
- ✅ **参数管理** - 动态添加/删除查询参数
- ✅ **请求头管理** - 表单/Raw双模式
- ✅ **请求体编辑** - 支持JSON、表单、原始数据
- ✅ **认证支持** - Bearer Token、Basic Auth、API Key等
- ✅ **认证自动填充** - 编辑时自动检测并填充认证信息
- ✅ **格式化/压缩** - JSON一键格式化和压缩

### 7. 请求操作
- ✅ **重放请求** - 一键重新发送请求
- ✅ **刷新页面** - 重新加载页面并捕获新请求
- ✅ **清空列表** - 快速清空请求列表
- ✅ **导出数据** - 导出为JSON文件
- ✅ **导入数据** - 从JSON文件导入
- ✅ **cURL导入** - 解析并导入cURL命令

## 🎨 UI/UX特性

### 视觉设计
- ✅ **现代化界面** - 精美的UI设计
- ✅ **颜色编码** - 不同HTTP方法使用不同颜色
- ✅ **选中高亮** - 选中请求时颜色与方法颜色一致
- ✅ **Emoji图标** - 所有选项使用emoji增强可读性
- ✅ **状态指示** - 清晰的成功/错误状态显示

### 交互优化
- ✅ **折叠区域** - 所有详情区域支持展开/折叠
- ✅ **视图切换** - 格式化/原始双视图无缝切换
- ✅ **模态框** - 大尺寸模态框提供充足空间
- ✅ **通知提示** - 操作成功/失败的即时反馈
- ✅ **加载动画** - 刷新等操作的视觉反馈

### 布局优化
- ✅ **响应式设计** - 适配不同屏幕尺寸
- ✅ **容器溢出控制** - 防止内容溢出
- ✅ **完美对齐** - 所有元素垂直居中对齐
- ✅ **下拉框优化** - 防止漂移和重叠

## 🔧 技术特性

### 请求拦截
```javascript
// 拦截fetch和XMLHttpRequest
// 自动解析JSON响应
// 智能去重（500ms窗口）
// 请求指纹：method:url:body:status
```

### 数据处理
```javascript
// 双重去重（前端+后端）
// 只保存完整请求（有响应和耗时）
// 自动JSON解析
// Headers标准化处理
```

### 视图模式
```javascript
// 格式化模式：JSON.stringify(data, null, 2)
// 原始模式：JSON.stringify(data)
// 智能复制：根据当前视图模式
```

### 认证检测
```javascript
// 编辑请求时自动检测Authorization头
// 使用_pendingAuthHeaders保存待处理的认证信息
// 使用_authTabInitialized标志防止重复初始化
// 只在第一次切换到认证tab时初始化和填充
// 切换tab后认证信息保持不变
// Bearer Token自动提取和填充
// Basic Auth自动解码和填充
// 支持多种认证类型（Bearer、Basic、API Key等）
// 添加详细调试日志便于排查问题
```

## 📚 使用指南

### 基本使用
1. 安装插件后，打开F12开发者工具
2. 点击"RestFlow"标签页
3. 浏览网页，请求会自动显示
4. 点击请求查看详情
5. 使用复制、重放等功能

### 高级功能
1. **新建请求** - 点击"新建"按钮创建自定义请求
2. **编辑请求** - 选中请求后点击"编辑"按钮
3. **代码生成** - 点击"复制"按钮选择代码格式
4. **cURL导入** - 点击"导入cURL"按钮粘贴命令
5. **数据管理** - 使用导入/导出功能管理请求数据

### 快捷操作
- **搜索** - 直接在搜索框输入URL关键词
- **过滤** - 使用下拉框快速过滤请求
- **清空** - 点击搜索框的×按钮清空搜索
- **刷新** - 点击刷新按钮重新加载页面
- **清空列表** - 点击扫帚图标清空请求列表

## 🐛 已修复问题

### 核心问题
1. ✅ 重复请求捕获 - 实现智能去重
2. ✅ 名称显示完整URL - 只显示最后一个路径段
3. ✅ 复制格式不正确 - 根据视图模式智能复制
4. ✅ Headers显示[object Object] - 标准化处理
5. ✅ 响应体无法展开 - 修复JSON树展开逻辑
6. ✅ 下拉框重叠 - 移除冲突动画
7. ✅ 认证信息不显示 - 使用requestAnimationFrame

### UI问题
1. ✅ 折叠icon对齐 - 完美垂直对齐
2. ✅ 容器溢出 - 多层宽度限制
3. ✅ 选中颜色不一致 - 统一颜色映射
4. ✅ 模态框太小 - 增大尺寸
5. ✅ 请求头切换问题 - 限制作用域

### 功能问题
1. ✅ 格式化按钮无反应 - 添加事件绑定
2. ✅ 压缩按钮无反应 - 添加事件绑定
3. ✅ 认证类型不对应 - 自动检测和填充
4. ✅ 认证信息不显示 - 延迟加载确保DOM就绪
5. ✅ 认证信息切换tab后重置 - 使用标志防止重复初始化
6. ✅ 请求体类型不对应 - 自动检测JSON

## 📊 性能优化

- ✅ 请求数量限制（最多1000个）
- ✅ 缓存自动清理
- ✅ 懒加载渲染
- ✅ 事件委托
- ✅ DOM直接操作（避免重新渲染）

## 📝 相关文档

- [README.md](README.md) - 项目介绍和安装指南
- [CHANGELOG.md](CHANGELOG.md) - 详细的更新日志
- [INSTALL.md](INSTALL.md) - 安装说明
- [TEST_GUIDE.md](TEST_GUIDE.md) - 测试指南
- [NETWORK_IMPORT_GUIDE.md](NETWORK_IMPORT_GUIDE.md) - 网络导入指南

---

**版本**: v1.0.0  
**最后更新**: 2025年
